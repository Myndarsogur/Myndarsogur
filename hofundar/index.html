<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#16dcf2" id="themeColor">
  <title>Höfundar</title>
  <style>
    /* Letur */
    @font-face{
      font-family: "CCBiffBamBoom";
      src: url("../assets/fonts/CCBiffBamBoom.woff2") format("woff2");
      font-display: swap;
    }
    @font-face{
      font-family: "CCHypnotique";
      src: url("../assets/fonts/CCHypnotique-Regular.woff2") format("woff2");
      font-display: swap;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:#16dcf2; /* ljósblár bakgrunnur */
      color:#fff;
      display:grid;
      place-items:center;
      font-family:"CCHypnotique", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Noto Sans", sans-serif;
      transition: background-color .35s ease;
    }

    .stage{
      width:min(1000px, 94vw);
      display:grid;
      gap:16px;
      position:relative;
      padding:20px 0 28px;
    }

    /* Kort: bara nafn + mynd */
    .card{
      display:grid;
      grid-template-columns: 1fr 1.1fr;
      gap: clamp(12px, 4vw, 28px);
      align-items:center;
      position: relative;
      z-index: 2; /* ofan á navzone */
    }
    @media (max-width:820px){
      .card{ grid-template-columns: 1fr; }
    }

    .name-wrap{
      position:relative;
      display:grid;
      justify-items:center;
    }
    .name{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:clamp(8px, 3vw, 18px);
      font-family:"CCHypnotique","CCBiffBamBoom", Impact, Haettenschweiler, "Arial Black", sans-serif;
      font-size:clamp(32px, 8vw, 68px);
      line-height:.95;
      margin:0;
      text-wrap:balance;
      letter-spacing:.3px;
      text-shadow: 0 2px 0 rgba(0,0,0,.25);
    }
    /* Gerum nafnið að hlekk en látum það líta út eins og haus */
    .name a{
      color:inherit;
      text-decoration:none;
      cursor:pointer;
    }
    .name a:hover{ text-decoration: underline; text-underline-offset: 4px; }

    .name-nav{
      appearance:none;
      border:0;
      background:transparent;
      color:#fff;
      font-family:"CC Kiss And Tell", "CCBiffBamBoom", Impact, sans-serif;
      font-size:clamp(28px, 6vw, 44px);
      line-height:1;
      cursor:pointer;
      padding:0 clamp(8px, 2vw, 16px);
      transition:transform .2s ease, opacity .2s ease;
    }
    .name-nav:hover,
    .name-nav:focus-visible{
      transform:translateY(-2px);
      opacity:1;
      outline:2px solid rgba(255,255,255,0.75);
      outline-offset:4px;
    }
    .name-nav:active{ transform:translateY(0); }

    .portrait-wrap{
      width:100%;
      aspect-ratio: 4 / 5;
      border-radius: 18px;
      overflow:hidden;
      border:2px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.08);
      cursor:pointer; /* sýna að hægt sé að smella */
      position: relative;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: clamp(6px, 1vw, 12px);
    }
    .portrait{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      transition:opacity .35s ease;
    }

    /* Flip hint */
    .flip-hint{
      position:fixed;
      bottom:20px;
      left:50%;
      transform:translateX(-50%);
      background:transparent;
      color:#fff;
      padding:10px 14px;
      border-radius:14px;
      font-family:"CCHypnotique","CCBiffBamBoom", Impact, sans-serif;
      font-size:16px;
      letter-spacing:.4px;
      box-shadow:none;
      opacity:0;
      pointer-events:none;
      transition:opacity .25s ease;
    }
    .flip-hint.visible{
      opacity:1;
    }
    .portrait.is-loading{ opacity:0; }

    .arrow-nav{ display:flex; justify-content:center; gap:clamp(28px, 12vw, 56px); margin-top:24px; }
    .arrow-btn{
      pointer-events:auto;
      appearance:none;
      border:0;
      background:transparent;
      color:#fff;
      font-family:"CC Kiss And Tell", "CCBiffBamBoom", Impact, sans-serif;
      font-size:clamp(36px, 12vw, 60px);
      line-height:1;
      padding:clamp(10px, 3vw, 16px) clamp(28px, 7vw, 40px);
      cursor:pointer;
      transition:transform .2s ease, opacity .2s ease;
    }
    .arrow-btn:hover,
    .arrow-btn:focus-visible{
      transform:translateY(-3px);
      opacity:1;
      outline:2px solid rgba(255,255,255,0.8);
      outline-offset:4px;
    }
    .arrow-btn:active{ transform:translateY(0); }
    .arrow-btn[disabled]{ opacity:0.3; cursor:default; transform:none; outline:none; }

    /* Vinstri/hægri klikksvæði undir kortinu (fyrir flettingu í auðu svæði) */
    .navzone{ position:absolute; top:0; bottom:0; width:50%; z-index:1; }
    .prev{ left:0; } .next{ right:0; }
    .navzone:active{ background: rgba(255,255,255,.03); }

    /* Dots */
    footer{ display:flex; justify-content:center; gap:0; flex-wrap:wrap; position: relative; z-index: 2; }
    .dot{ display:none; }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; animation:none !important; }
    }
  </style>
</head>
<body>
  <div class="stage" role="application" aria-label="Fletting á milli höfunda">
    <div class="card" id="card">
      <!-- Nafnið er núna hlekkur -->
      <div class="name-wrap">
        <h2 class="name" id="name">
          <a id="nameLink" href="#" target="_blank" rel="noopener">—</a>
        </h2>
      </div>

      <!-- Myndin er EKKI hlekkur — hún stýrir flettingu -->
      <div id="portraitWrap" class="portrait-wrap" aria-label="Smelltu á vinstri/hægri helming til að fletta">
        <img id="portrait" class="portrait" src="" alt="Höfundamynd" loading="lazy" decoding="async">
      </div>
    </div>

    <footer id="dots" aria-label="Staða"></footer>
    <div class="arrow-nav" aria-hidden="false">
      <button type="button" class="arrow-btn" id="arrowPrev" aria-label="Fletta til baka">←</button>
      <button type="button" class="arrow-btn" id="arrowNext" aria-label="Fletta áfram">→</button>
    </div>

    <!-- hálfskjás-klikk (heldur áfram að virka í auðu svæðunum) -->
    <div class="navzone prev" title="Fletta til baka" aria-label="Fletta til baka"></div>
    <div class="navzone next" title="Fletta áfram" aria-label="Fletta áfram"></div>
  </div>

  <div class="flip-hint" id="flipHint" role="status">Smelltu til að fletta →</div>

  <script>
    const mediaBase = "Birt";
    const slidesByFolder = {
      "Addi Nabblakusk": [
        "addi-nabblakusk.avif"
      ],
      "Astrid M Stefánsdóttir": [
        "astrid-m-stefansdottir.avif"
      ],
      "Bjarni Pálsson": [
        "bjarni-palsson.avif"
      ],
      "Fannar G. Gilbertsson": [
        "fannar-g-gilbertsson.avif"
      ],
      "Finnur Matteo Bettaglio": [
        "finnur-matteo-bettaglio.avif"
      ],
      "Gísli Dan": [
        "gisli-dan.avif"
      ],
      "I.R. Kjartansson": [
        "ir-kjartansson.avif"
      ],
      "J.J. Mancho": [
        "jj-mancho.avif"
      ],
      "Kris Helga": [
        "kris-helga.avif"
      ],
      "Lísa Margrét": [
        "lisa-margret.avif"
      ],
      "Lúkas og Matthías Regal": [
        "lukas-og-matthias-regal.avif"
      ],
      "Sharky Sharky": [
        "sharky-sharky.avif"
      ],
      "Sunneva Thomsen": [
        "sunneva-thomsen.avif"
      ],
      "Sólveig Eva Magnúsdóttir": [
        "solveig-eva-magnusdottir.avif"
      ],
      "Una Björk": [
        "una-bjork.avif"
      ],
      "Ísold Davíðsdóttir": [
        "isold-davidsdottir.avif"
      ],
      "Ómar Vídó": [
        "omar-vido.avif"
      ]
    };

    function encodeSegment(segment){
      return encodeURIComponent(segment).replace(/%2F/g, "/");
    }

    function buildSlidePath(folder, file){
      return `${mediaBase}/${encodeSegment(folder)}/${encodeSegment(file)}`;
    }
    function buildFallback(folder, file){
      const webp = file.replace(/\.avif$/i, ".webp");
      return `${mediaBase}/${encodeSegment(folder)}/${encodeSegment(webp)}`;
    }
    const PLACEHOLDER = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 1000'><rect width='100%' height='100%' fill='%23b00000'/><text x='50%' y='50%' fill='%23ffffff' font-size='48' font-family='Arial' dominant-baseline='middle' text-anchor='middle'>Mynd%20vantar</text></svg>";

    const authors = [
      { name: "Fannar G. Gilbertsson", url: "https://fannargg.com",                                        folder: "Fannar G. Gilbertsson" },
      { name: "Finnur Matteo Bettaglio", url: "https://finnurmatteo.myportfolio.com",                                                          folder: "Finnur Matteo Bettaglio" },
      { name: "Ísold Davíðsdóttir",     url: "https://www.instagram.com/aparasscomix/",                                                          folder: "Ísold Davíðsdóttir" },
      { name: "Kris Helga",             url: "https://www.instagram.com/kris_helga_art/?hl=en",                                                          folder: "Kris Helga" },
      { name: "I.R. Kjartansson",       url: "https://www.instagram.com/i.r.kjartansson_/?hl=en",         folder: "I.R. Kjartansson" },
      { name: "Ómar Vídó",              url: "https://www.instagram.com/robotic_turtle/",                                                          folder: "Ómar Vídó" },
      { name: "Bjarni Pálsson",         url: "https://www.jolaljosamadurinn.com/",                        folder: "Bjarni Pálsson" },
      { name: "Gísli Dan",              url: "https://www.instagram.com/gisli.dan.illustrations/?hl=en",  folder: "Gísli Dan" },
      { name: "Sharky Sharky",          url: "https://www.instagram.com/babys.got.a.gun/",                                                          folder: "Sharky Sharky" },
      { name: "Astrid M Stefánsdóttir", url: "https://www.instagram.com/astrid.stefans/?hl=en",                                                          folder: "Astrid M Stefánsdóttir" },
      { name: "Addi Nabblakusk",        url: "https://www.instagram.com/addinabblakusk/?hl=en",                                                          folder: "Addi Nabblakusk" },
      { name: "J.J. Mancho",            url: "https://www.domestika.org/es/jjmancho/portfolio",           folder: "J.J. Mancho" },
      { name: "Lúkas og Matthías Regal",url: "https://www.instagram.com/lukas_regal/?hl=en",              folder: "Lúkas og Matthías Regal" },
      { name: "Sólveig Eva Magnúsdóttir", url: "https://solaeva.com",                                                        folder: "Sólveig Eva Magnúsdóttir" },
      { name: "Sunneva Thomsen",        url: "https://www.instagram.com/sunnevaart/?hl=en",               folder: "Sunneva Thomsen" },
      { name: "Lísa Margrét",           url: "https://www.instagram.com/lismargur_art/",                                                          folder: "Lísa Margrét" },
      { name: "Una Björk",              url: "https://www.instagram.com/freckled.fairy/?hl=en",                                                          folder: "Una Björk" }
    ];

    authors.forEach((author) => {
      const files = slidesByFolder[author.folder] || [];
      author.slides = files.map((file) => {
        if(file.startsWith("data:")) return file;
        const primary = buildSlidePath(author.folder, file);
        const fallback = buildFallback(author.folder, file);
        return { primary, fallback };
      });
      if(!author.slides.length){
        author.slides = [PLACEHOLDER];
      }
    });

    const themeMeta     = document.getElementById("themeColor");
    const nameLinkEl    = document.getElementById("nameLink");
    const portraitEl    = document.getElementById("portrait");
    const portraitWrap  = document.getElementById("portraitWrap");
    const dotsEl        = document.getElementById("dots");
    const prevZone      = document.querySelector(".navzone.prev");
    const nextZone      = document.querySelector(".navzone.next");
    const arrowPrevBtn = document.getElementById("arrowPrev");
    const arrowNextBtn = document.getElementById("arrowNext");

    let authorIndex = 0;
    let slideIndex = 0;
    const preloaded = new Set();
    const flipHint = document.getElementById("flipHint");
    let flipTimer = null;
    let hasInteracted = false;

    function redShade(){
      return "#16dcf2";
    }

    function renderDots(){
      dotsEl.innerHTML = "";
      authors.forEach((author, idx) => {
        const dot = document.createElement("button");
        dot.type = "button";
        dot.className = "dot" + (idx === authorIndex ? " active" : "");
        dot.setAttribute("aria-label", `Fara í ${author.name}`);
        dot.addEventListener("click", () => {
          markInteracted();
          authorIndex = idx;
          slideIndex = 0;
          render();
        });
        dotsEl.appendChild(dot);
      });
    }

    function preloadSlide(aIdx, sIdx){
      if(aIdx < 0 || aIdx >= authors.length) return;
      const slides = authors[aIdx].slides;
      if(!slides || sIdx < 0 || sIdx >= slides.length) return;
      const entry = slides[sIdx];
      const src = typeof entry === "string" ? entry : entry.primary;
      if(preloaded.has(src)) return;
      const img = new Image();
      img.src = src;
      preloaded.add(src);
    }

    portraitEl.addEventListener("load", () => {
      portraitEl.classList.remove("is-loading");
    });

    function renderSlide(){
      const author = authors[authorIndex];
      const slides = author.slides;
      slideIndex = Math.min(Math.max(slideIndex, 0), slides.length - 1);
      const entry = slides[slideIndex];
      const src = typeof entry === "string" ? entry : entry.primary;
      const fallback = typeof entry === "object" ? entry.fallback : null;
      const alt = `${author.name} — mynd ${slideIndex + 1} af ${slides.length}`;
      portraitEl.classList.add("is-loading");
      portraitEl.onerror = () => {
        if(fallback){
          portraitEl.onerror = null;
          portraitEl.src = fallback;
        } else {
          portraitEl.onerror = null;
          portraitEl.src = PLACEHOLDER;
        }
      };
      portraitEl.src = src;
      portraitEl.alt = alt;
      preloadSlide(authorIndex, slideIndex + 1);
      preloadSlide(authorIndex + 1, 0);
    }

    function render(){
      const author = authors[authorIndex];
      nameLinkEl.textContent = author.name;
      if(author.url){
        nameLinkEl.href = author.url;
        nameLinkEl.setAttribute("target", "_blank");
        nameLinkEl.setAttribute("rel", "noopener");
      } else {
        nameLinkEl.href = "#";
        nameLinkEl.removeAttribute("target");
        nameLinkEl.removeAttribute("rel");
      }

      const bg = redShade(authorIndex, authors.length);
      document.body.style.background = bg;
      themeMeta.setAttribute("content", bg);
      document.title = `${author.name} — Höfundar`;

      renderDots();
      renderSlide();
      updateNavState();
    }

    function hideFlipHint(){
      if(flipHint){
        flipHint.classList.remove("visible");
      }
    }
    function scheduleFlipHint(){
      if(flipTimer){
        clearTimeout(flipTimer);
        flipTimer = null;
      }
      if(hasInteracted || !flipHint) return;
      flipTimer = window.setTimeout(()=>{
        if(!hasInteracted && flipHint){
          flipHint.classList.add("visible");
        }
      }, 3000);
    }
    function markInteracted(){
      hasInteracted = true;
      hideFlipHint();
      if(flipTimer){
        clearTimeout(flipTimer);
        flipTimer = null;
      }
    }

    function next(){
      markInteracted();
      const slides = authors[authorIndex].slides;
      if(slideIndex < slides.length - 1){
        slideIndex += 1;
        renderSlide();
        updateNavState();
      } else if(authorIndex < authors.length - 1){
        authorIndex += 1;
        slideIndex = 0;
        render();
      }
    }

    function prev(){
      markInteracted();
      if(slideIndex > 0){
        slideIndex -= 1;
        renderSlide();
        updateNavState();
      } else if(authorIndex > 0){
        authorIndex -= 1;
        slideIndex = authors[authorIndex].slides.length - 1;
        render();
      }
    }

    function updateNavState(){
      const slides = authors[authorIndex].slides;
      const canPrev = slideIndex > 0 || authorIndex > 0;
      const canNext = slideIndex < slides.length - 1 || authorIndex < authors.length - 1;
      arrowPrevBtn.disabled = !canPrev;
      arrowNextBtn.disabled = !canNext;
    }

    nextZone.addEventListener("click", next);
    prevZone.addEventListener("click", prev);
    arrowNextBtn.addEventListener("click", next);
    arrowPrevBtn.addEventListener("click", prev);
    window.addEventListener("keydown", (e)=>{
      if(e.key === "ArrowRight"){ next(); return; }
      if(e.key === "ArrowLeft"){  prev(); return; }
    });

    portraitWrap.addEventListener("click", (e)=>{
      markInteracted();
      const rect = portraitWrap.getBoundingClientRect();
      const x = e.clientX - rect.left;
      if(x < rect.width / 2){ prev(); } else { next(); }
    });

    let touchX = null;
    window.addEventListener("touchstart", (e)=>{
      markInteracted();
      touchX = e.changedTouches[0].clientX;
    }, {passive:true});
    window.addEventListener("touchend", (e)=>{
      if(touchX == null) return;
      const dx = e.changedTouches[0].clientX - touchX;
      if(Math.abs(dx) > 40){ dx < 0 ? next() : prev(); }
      touchX = null;
    }, {passive:true});

    render();
    scheduleFlipHint();
  </script>
</body>
</html>
